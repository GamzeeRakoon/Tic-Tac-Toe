import{s as j,e as O,t as W,c as k,b as C,d as q,f as v,m as N,i as R,h as w,p as G,q as H,j as z,n as P,a as J,g as K,u as L,k as T,v as Q}from"../chunks/scheduler.cwPrGksG.js";import{S as A,i as U,t as D,c as Y,a as E,b as Z,d as $,m as ee,e as te,g as ne}from"../chunks/index.csaw_Ye6.js";import{g as se,p as le,d as _,r as ae,a as re}from"../chunks/store.DzbeFD6T.js";import{l as oe}from"../chunks/index.1HjZlvs3.js";function V(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ie(n){let e,s=(n[0]||"")+"",c,i,m;return{c(){e=O("button"),c=W(s),this.h()},l(r){e=k(r,"BUTTON",{type:!0,class:!0});var d=C(e);c=q(d,s),d.forEach(v),this.h()},h(){e.disabled=n[2],N(e,"type","button"),N(e,"class","btn variant-ringed-tertiary size-32 flex items-center justify-center rounded-none")},m(r,d){R(r,e,d),w(e,c),i||(m=G(e,"click",function(){H(n[1])&&n[1].apply(this,arguments)}),i=!0)},p(r,[d]){n=r,d&1&&s!==(s=(n[0]||"")+"")&&z(c,s),d&4&&(e.disabled=n[2])},i:P,o:P,d(r){r&&v(e),i=!1,m()}}}function ce(n,e,s){let{value:c}=e,{handleClick:i}=e,{disableBoard:m}=e;return n.$$set=r=>{"value"in r&&s(0,c=r.value),"handleClick"in r&&s(1,i=r.handleClick),"disableBoard"in r&&s(2,m=r.disableBoard)},[c,i,m]}class ue extends A{constructor(e){super(),U(this,e,ce,ie,j,{value:0,handleClick:1,disableBoard:2})}}function X(n,e,s){const c=n.slice();return c[15]=e[s],c[17]=s,c}function M(n){let e,s;function c(){return n[4](n[17])}return e=new ue({props:{disableBoard:n[2],value:n[15],handleClick:c}}),{c(){Z(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,m){ee(e,i,m),s=!0},p(i,m){n=i;const r={};m&4&&(r.disableBoard=n[2]),m&1&&(r.value=n[15]),e.$set(r)},i(i){s||(D(e.$$.fragment,i),s=!0)},o(i){E(e.$$.fragment,i),s=!1},d(i){te(e,i)}}}function de(n){let e,s,c,i,m,r,d,p=V(n[0]),l=[];for(let a=0;a<p.length;a+=1)l[a]=M(X(n,p,a));const S=a=>E(l[a],1,1,()=>{l[a]=null});return{c(){e=O("div"),s=O("div"),c=O("p"),i=W(n[1]),m=J(),r=O("div");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=k(a,"DIV",{class:!0});var u=C(e);s=k(u,"DIV",{class:!0});var o=C(s);c=k(o,"P",{});var b=C(c);i=q(b,n[1]),b.forEach(v),m=K(o),r=k(o,"DIV",{class:!0});var x=C(r);for(let y=0;y<l.length;y+=1)l[y].l(x);x.forEach(v),o.forEach(v),u.forEach(v),this.h()},h(){N(r,"class","grid grid-cols-3"),N(s,"class","card p-4 text-center"),N(e,"class","h-full flex flex-col items-center justify-center")},m(a,u){R(a,e,u),w(e,s),w(s,c),w(c,i),w(s,m),w(s,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(r,null);d=!0},p(a,[u]){if((!d||u&2)&&z(i,a[1]),u&13){p=V(a[0]);let o;for(o=0;o<p.length;o+=1){const b=X(a,p,o);l[o]?(l[o].p(b,u),D(l[o],1)):(l[o]=M(b),l[o].c(),D(l[o],1),l[o].m(r,null))}for(ne(),o=p.length;o<l.length;o+=1)S(o);Y()}},i(a){if(!d){for(let u=0;u<p.length;u+=1)D(l[u]);d=!0}},o(a){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)E(l[u]);d=!1},d(a){a&&v(e),L(l,a)}}}function fe(n,e,s){let c,i;T(n,ae,t=>s(7,c=t)),T(n,_,t=>s(2,i=t));let{subscribe:m,update:r}=re;const d=se(),p=oe();let l,S,a,u;le.subscribe(t=>{a=t.name}),m(t=>{S=t.xIsNext,s(0,l=t.squares)});const o=t=>{if(!l[t]){const f=l.slice();f[t]=S?"X":"O";let B=a,g=f[t],h=t;const I=b(f);if(I==="X"||I=="O"){p.emit("gameOver",I,f);return}p.emit("playing",{value:g,id:h,name:B})}};p.on("playing",t=>{const f=t.allPlayers.find(h=>h.p1.p1name==`${a}`||h.p2.p2name==`${a}`);let B=f.p1.p1move,g=f.p2.p2move;if(f.sum%2==0?(s(1,u="O's turn"),_.set(!1)):(s(1,u="X's turn"),_.set(!1)),B!==""){let h=l.slice();h[B]="X",f.p1.p1name==a&&_.set(!0),r(()=>({winner:null,xIsNext:!1,squares:h}))}if(g!==""){let h=l.slice();h[g]="O",f.p2.p2name==a&&_.set(!0),r(()=>({winner:null,xIsNext:!0,squares:h}))}}),p.on("gameOver",(t,f)=>{_.set(!0),r(()=>({winner:t,xIsNext:!1,squares:f})),(t=="X"||t=="O")&&x(t),t=="draw"&&y(),setTimeout(()=>{window.location.href="/"},5e3)});const b=t=>{const f=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let g=0;g<f.length;g++){const[h,I,F]=f[g];if(t[h]&&t[h]===t[I]&&t[h]===t[F])return t[h]}return t.every(g=>g!==null)?"draw":null},x=t=>{const f={type:"alert",title:"Winner!",body:`player ${t} has won the game!`};return d.trigger(f),""},y=()=>{const t={type:"alert",title:"Draw!",body:"It's a draw!"};return d.trigger(t),""};return Q(()=>{if(c){window.location.href="/";return}d.close()}),[l,u,i,o,t=>o(t)]}class ve extends A{constructor(e){super(),U(this,e,fe,de,j,{})}}export{ve as component};
